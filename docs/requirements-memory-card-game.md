# メモリーカードゲーム 要件定義書

## 1. プロジェクト概要
- **タイトル（仮）**: メモリーカードゲーム（最終名称は後日決定）
- **目的**: 小学5年生向けに、記憶力と集中力を楽しく鍛えるブラウザ&スマホ対応の神経衰弱ゲームを提供する。
- **開発体制**: チャッピー（要件整理・分析）、クロ（実装）、じぇみ（必要に応じたアイデア支援）。
- **タイムライン制約**: MVP版の初期実装は要件確定後1時間以内を目標とする。

## 2. ターゲットとプラットフォーム
- **想定プレイヤー**: 小学5年生（10〜11歳）。ひとり遊び前提。
- **対応端末**: スマートフォン（iOS/Androidの最新ブラウザ）とPCブラウザ（Chrome / Safari / Edge 最新版）。
- **利用環境**: オンライン前提。インストール不要のWebブラウザアプリとして提供。
- **言語対応**: 日本語のみをサポート。

## 3. ゲーム仕様
### 3.1 基本ルール
- 神経衰弱形式のペアマッチゲーム。
- プレイヤーはカードを2枚めくり、同一カードであればペア成立としてカードを消す。
- 全てのペアを揃えるとゲームクリア。

### 3.2 カード構成
- 表示枚数は10枚（5ペア）〜15枚（7ペア＋1枚余り無し）から選択可能。
- カードデザインはフリー素材を利用し、テーマは子どもに親しみやすい動物・食べ物・キャラクター風シルエット等を想定。
- カード裏面は共通デザイン（ポップでカラフルな柄）を使用。

### 3.3 難易度設定
- 難易度に応じてカード枚数・制限時間・ヒント機能を調整。
  - **やさしい**: 10枚、制限時間なし、1回だけ全カードオープンのヒント使用可。
  - **ふつう**: 12枚、制限時間90秒、ヒントなし。
  - **むずかしい**: 15枚、制限時間60秒、ヒントなし。

### 3.4 スコアリング
- スコアは以下を総合して算出し、最高スコアを保存。
  - 残り時間（タイムボーナス）
  - 連続で成功したペア数（コンボボーナス）
  - ミス（不一致）回数による減点
- ゲームクリア時にスコア画面を表示し、最高記録を更新した場合は祝福演出を行う。

### 3.5 進行状況管理
- プレイ中の進行状況（現行難易度、めくったカード状態、残り時間、現在スコア）を一定間隔でローカルストレージに保存。
- ブラウザを閉じても、次回起動時に「続きから再開」オプションを提示。

## 4. UI/UX 要件
- **デザインテイスト**: カラフルで明るく、肩の力を抜けるポップテイスト。小学5年生が直感的に操作できる大きめボタンと文字サイズ。
- **レイアウト**: スマホ縦画面を優先。グリッドレイアウトでカードを均等配置し、レスポンシブにPC表示へ拡張。
- **操作**: タップ/クリックのみで完結。カード選択はアニメーションで反応を示す。
- **演出**: 
  - カードをめくる際は軽いフリップアニメーション。
  - ペア成立時はキラキラ演出と短い効果音。
  - 失敗時は軽い振動（CSSアニメーション）と柔らかい効果音。
- **ユーザーフィードバック**: 残り時間・現在スコア・達成ペア数を常時表示し、視認性を高く保つ。
- **アクセシビリティ**: 
  - 色弱対応としてカードアイコンは色＋形状で区別。
  - 画面読み上げ向けにARIA属性を設定。

## 5. オーディオ要件
- 効果音はフリー素材（CC0または明示的な商用可）を利用する。
- BGMはオプション（初期状態でON）。ユーザーが設定からON/OFF切替可能。
- 音量はブラウザ標準のサウンド設定に依存しつつ、ゲーム内トグルを提供。

## 6. データ保存仕様
- **保存先**: ブラウザの `localStorage` を利用。
- **保存項目**:
  - 最後に選択した難易度
  - 最高スコア（難易度別に管理）
  - 途中再開用セッションデータ（カード配置、ペア状態、残り時間、現在スコア）
- **保存タイミング**: 
  - ゲーム開始時・一定間隔（例: 5秒ごと）・カードペア確定時・ゲーム終了時。
- **データ保持期間**: ユーザーがブラウザデータをクリアするまで。
- **プライバシー**: 個人情報は扱わない。

## 7. 技術要件
- **フレームワーク**: React 18.x（Vite または Create React App ベースを後日選定）。
- **言語**: TypeScript を推奨（静的型で安全性確保）。JavaScriptで進める場合はESLintで補完。
- **状態管理**: React組み込みのフック（`useState`, `useReducer`）を基本とし、複雑化した場合はZustand等を検討。
- **ビルド/開発ツール**: Vite + ESLint + Prettier を想定。
- **テスト**: React Testing Library + Jestで主要コンポーネントのユニットテストを最低限実装。
- **レスポンシブ対応**: CSS GridとFlexboxを併用し、Tailwind CSSまたはCSS Modulesを選択。

## 8. 非機能要件
- **パフォーマンス**: LCP 2.5秒以内、初回ロードサイズは1MB以内を目標。
- **オフライン性**: 初期リリースでは必須としない。今後PWA対応を検討。
- **セキュリティ**: 外部通信なし。ローカルストレージのみ利用のためXSS対策（エスケープ・危険なHTML非使用）を徹底。
- **可用性**: 単純構成のため99%以上（ブラウザアプリ基準）。障害時は再読み込みで復旧。

## 9. 運用・拡張方針
- **マルチプレイ**: 初期リリース範囲外。オンライン/ローカル対戦案は今後検討。
- **コンテンツ追加**: カードテーマを増やす際はJSON定義ファイルを追加するだけで拡張可能な構造にする。
- **イベント機能**: 季節イベントやデイリーチャレンジは将来的な改善候補。
- **分析**: 匿名のプレイログ取得は現時点で実施しない（小学5年生向け・プライバシー配慮）。

## 10. テストと品質保証
- **テスト方針**:
  - 難易度3段階すべてでカードが正しく表示・ペア判定されるか。
  - ローカルストレージに設定・最高スコア・途中セッションが保存/再開できるか。
  - スマホ（iPhone, Android）とPC主要ブラウザでの表示崩れがないか。
- **検証手順**:
  - 手動テストシナリオを作成し、QAチェックリストに沿って検証。
  - ビルド時に自動テストを走らせ、主要コンポーネントの回帰を防止。

## 11. 外部依存
- フリー画像・効果音（ライセンス表記不要か確認。必要な場合はクレジット欄を設置）。
- Reactおよび関連ツールチェーン（Vite, ESLint, Testing Libraryなど）。

## 12. リスクと対策
- **スケジュール圧縮（1時間以内MVP）**: MVP段階は最小機能（10枚、難易度固定、スコア簡易化）でスコープを絞り、残りは段階的に追加する。
- **小学生に対する難易度過多**: 難易度調整機能で対応し、初回は「やさしい」をデフォルトに設定。
- **端末性能差**: アニメーションの負荷を抑えるためCSSトランジションを中心に採用し、GPU依存を減らす。

## 13. オープン課題
- 最終的なゲームタイトル・ブランドイメージの確定。
- 使用する具体的なフリー素材の選定とライセンス確認。
- BGM導入の有無と曲調の最終決定。
- MVP後に取り組むマルチプレイ仕様の検討。

## 14. 次のステップ
1. 本要件定義書のフィードバックを反映し、確定版を承認。
2. 技術設計書のドラフトを作成（アーキテクチャ、コンポーネント構成、データ構造）。
3. 実装計画書を作成し、1時間MVPに収まる最小スコープを明確化。

